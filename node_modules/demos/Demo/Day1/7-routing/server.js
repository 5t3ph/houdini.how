var http = require("http");
var url = require("url");

function init(dispatch, handle) {  
	function onRequest(request, response) {    
		var path = url.parse(request.url).pathname;    
		console.log("Request for " + path + " received.");    
		response.writeHead(200, {"Content-Type": "text/plain"});  
		var content = dispatch(handle, path);		
		response.write(content);  
		response.end();
	}
	http.createServer(onRequest).listen(7777);
	console.log("Server has started...");
}

exports.init=init;


