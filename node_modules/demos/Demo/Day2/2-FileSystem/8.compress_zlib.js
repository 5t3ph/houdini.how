var fs = require('fs');
var zlib = require('zlib');

var gzip = zlib.createGzip();
var rstream = fs.createReadStream('test.txt');
var wstream = fs.createWriteStream('test.txt.gz');

rstream   // reads from test.txt
  .pipe(gzip)  // compresses
  .pipe(wstream)  // writes to test.txt.gz
  .on('finish', function () {  // finished
    console.log('Finished compressing');
  });
  